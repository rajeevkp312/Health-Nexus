<!DOCTYPE html>
<html>
<head>
    <title>Simple Doctor Test</title>
    <style>
        .doctor-card {
            border: 1px solid #ccc;
            margin: 10px;
            padding: 10px;
            display: inline-block;
            width: 200px;
        }
        .doctor-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <h1>Simple Doctor Image Test</h1>
    <button onclick="loadDoctors()">Load Doctors</button>
    <div id="doctors"></div>
    
    <script>
        async function loadDoctors() {
            try {
                console.log('Fetching doctors...');
                const response = await fetch('http://localhost:8000/api/admin/doctors');
                const data = await response.json();
                
                console.log('API Response:', data);
                
                if (data.msg === "Success") {
                    const doctors = data.value || data.doctors || [];
                    const doctorsDiv = document.getElementById('doctors');
                    doctorsDiv.innerHTML = '';
                    
                    doctors.forEach(doctor => {
                        console.log(`Processing doctor: ${doctor.name}`);
                        console.log(`Image field:`, doctor.image);
                        
                        const card = document.createElement('div');
                        card.className = 'doctor-card';
                        
                        let imageUrl;
                        if (!doctor.image) {
                            imageUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(doctor.name)}&size=100&background=4f46e5&color=fff&bold=true`;
                        } else if (doctor.image.startsWith('data:image/')) {
                            imageUrl = doctor.image;
                        } else {
                            // Handle file path
                            let imagePath = doctor.image.replace(/^uploads[\\\/]/, '').replace(/\\/g, '/');
                            imageUrl = `http://localhost:8000/uploads/${imagePath}`;
                        }
                        
                        console.log(`Final image URL for ${doctor.name}:`, imageUrl);
                        
                        card.innerHTML = `
                            <h3>${doctor.name}</h3>
                            <img src="${imageUrl}" 
                                 alt="${doctor.name}" 
                                 class="doctor-image"
                                 onerror="console.error('Image failed:', this.src); this.src='https://ui-avatars.com/api/?name=${encodeURIComponent(doctor.name)}&size=100&background=ff0000&color=fff';">
                            <p>${doctor.specialty || 'Doctor'}</p>
                            <p>Experience: ${doctor.experience || 'N/A'} years</p>
                        `;
                        
                        doctorsDiv.appendChild(card);
                    });
                } else {
                    console.error('API Error:', data);
                }
            } catch (error) {
                console.error('Fetch Error:', error);
            }
        }
        
        // Auto-load on page load
        window.onload = loadDoctors;
    </script>
</body>
</html>
